{% extends 'main.html' %}

{% block content %}

{% load static %}

<!-- Start app main Content -->

<div class="main-content">
    <section class="section">
        <div class="section-header">
            <h1>PaySlip</h1>
            <div class="section-header-breadcrumb">
                <div class="breadcrumb-item active"><a href="{% url 'home' %}">Dashboard</a></div>
                <div class="breadcrumb-item">Payslip</div>
            </div>
        </div>

        <div class="section-body" id="printpayslip">
            <div class="invoice">
                <div class="invoice-print">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="invoice-title">
                                <h2>Payslip</h2>
                                <div class="invoice-number">{% now "d/m/Y" %}</div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-md-6">
                                    <address>
                                        <strong>Pay To:</strong><br>
                                        {{salary.employee.fullname}}<br>
                                        {{salary.employee.email}}<br>
                                        {{salary.employee.telephone}}<br>
                                        {{salary.employee.position}}<br>
                                        {% now "d/m/Y" %}
                                    </address>
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <address>

                                    </address>
                                </div>
                                <div class="col-md-6 text-md-right">
                                    <address>

                                    </address>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-md-10">
                            <div class="section-title">Salary details</div>
                            <p class="section-lead">Thanks for your service</p>.</p>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover table-md">
                                    <tr>
                                        <th data-width="40">#</th>
                                        <th>Income</th>
                                        <th class="text-center"></th>
                                        <th class="text-right">Totals</th>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>Salary</td>
                                        <td class="text-center"></td>
                                        <td class="text-right">Ksh. {{salary.salary}}</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>Allowances</td>
                                        <td class="text-center"></td>
                                        <td class="text-right">Ksh. {{salary.allowance}}</td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>NHIF</td>
                                        <td class="text-center"></td>
                                        <td class="text-right">Ksh. {{salary.nhif}}</td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>NSSF</td>
                                        <td class="text-center"></td>
                                        <td class="text-right">Ksh. {{salary.nssf}}</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="row mt-4">
                                <div class="col-lg-6">

                                </div>
                                <div class="col-lg-6 text-right">
                                    <div class="invoice-detail-item">
                                        <div class="invoice-detail-name">Total Incomes</div>
                                        <div class="invoice-detail-value">Ksh. {{salary.total_income}}</div>
                                    </div>
                                    <div class="invoice-detail-item">
                                        <div class="invoice-detail-name">Total Deductions</div>
                                        <div class="invoice-detail-value">Ksh. {{salary.total_deductions |floatformat:2}}</div>
                                    </div>
                                    <hr class="mt-2 mb-2">
                                    <div class="invoice-detail-item">
                                        <div class="invoice-detail-name">Pay after tax</div>
                                        <div class="invoice-detail-value">Ksh.
                                            {{salary.netSalary}}</div>
                                    </div>

                                    <div class="invoice-detail-item">
                                        <div class="invoice-detail-name">PAYE</div>
                                        <div class="invoice-detail-value">Ksh.
                                            {{salary.paye |floatformat:2}}</div>
                                    </div>

                                    <div class="invoice-detail-item">
                                        <div class="invoice-detail-name">Net Pay</div>
                                        <div class="invoice-detail-value invoice-detail-value-lg">Ksh.
                                            {{salary.netPaye |floatformat:2}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="text-md-right">
                    <a href="{% url 'payslip' salary.id %}" class="btn btn-success btn-icon icon-left print">
                        <i class="fas fa-print"></i> Print</a>
                </div>
                <div class="text-md-right">
                    
                    <button type="submit" value="click" onclick="generatePDF()"
                        class="btn btn-warning btn-icon icon-left print">
                        <i class="fas fa-print"></i> Print</button>
                </div>
            </div>
        </div>
    </section>
</div>

<script src="https://unpkg.com/jspdf-invoice-template@1.4.0/dist/index.js"></script>

<script type="text/javascript">
    function generatePDF() {
        var pdfObject = jsPDFInvoiceTemplate.default(props);

        console.log("Object created: ", pdfObject);
    }

    var props = {
        outputType: jsPDFInvoiceTemplate.Save,
        returnJsPDFDocObject: true,
        fileName: "{{salary.employee.idnumber}}_Payslip",
        orientationLandscape: false,
        compress: true,

        business: {
            name: "Panacea",
            address: "Nairobi, Kenya",
            phone: "+254 721345987",
            email_1: "info@panacea.co.ke",
            website: "https://panacea.co.ke",
        },
        contact: {
            label: "Payslip",
            name: "{{salary.employee.fullname}}",
            phone: "{{salary.employee.telephone}}",
            email: "{{salary.employee.email}}",
            id_No: "{{salary.employee.id}}",
        },
        invoice: {
            headerBorder: false,
            tableBodyBorder: false,
            header: [
                {
                    title: "#",
                    style: {
                        width: 20
                    }
                },
                {
                    title: "Title",
                    style: {
                        width: 120
                    }
                },

                { title: "Total" }
            ],
            table: [
                item = [
                    1,
                    "Salary",
                    "{{salary.salary}}"
                ],
                [
                    2,
                    "Allowances",
                    "{{salary.allowance}}"
                ],
                [
                    3,
                    "Nhif",
                    "{{salary.nhif}}"
                ],
                [
                    4,
                    "Nssf",
                    "{{salary.nssf}}"
                ],
                [
                    "",
                    "",
                    ""
                ],
                [
                    "",
                    "Total Income",
                    "{{salary.total_income}}"
                ],
                [
                    ,
                    "Total Deduction",
                    "{{salary.total_deductions}}"
                ],
                [
                    "",
                    "",
                    ""
                ],
                [
                    "",
                    "Net Salary",
                    "{{salary.netSalary}}"
                ]
            ],


            invDescLabel: "Invoice Note",
            invDesc: "There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable. If you are going to use a passage of Lorem Ipsum, you need to be sure there isn't anything embarrassing hidden in the middle of text. All the Lorem Ipsum generators on the Internet tend to repeat predefined chunks as necessary.",
        },
        footer: {
            text: "The invoice is created on a computer and is valid without the signature and stamp.",
        },
        pageEnable: true,
        pageLabel: "Page ",
    };
</script>

{% endblock %}